# Работа с GitHub через MCP Git Server

Этот документ описывает использование новых инструментов для работы с GitHub репозиториями и Pull Request'ами через MCP Git Server.

## Настройка

### GitHub Token (опционально)

Для работы с приватными репозиториями или увеличения лимита запросов к API, установите переменную окружения `GITHUB_TOKEN`:

```bash
# Windows
set GITHUB_TOKEN=your_github_token_here

# Linux/Mac
export GITHUB_TOKEN=your_github_token_here
```

**Лимиты API:**

- Без токена: 60 запросов/час
- С токеном: 5000 запросов/час

## Доступные инструменты

### 1. `github_list_repo_contents` - Просмотр содержимого репозитория

Получение списка файлов и папок в репозитории.

**Параметры:**

- `owner` (обязательно) - владелец репозитория
- `repo` (обязательно) - название репозитория
- `path` (опционально) - путь в репозитории (по умолчанию корень)
- `ref` (опционально) - ветка, тег или commit SHA

**Пример:**

```json
{
  "owner": "facebook",
  "repo": "react",
  "path": "packages"
}
```

### 2. `github_read_file` - Чтение файла из репозитория

Получение содержимого конкретного файла.

**Параметры:**

- `owner` (обязательно) - владелец репозитория
- `repo` (обязательно) - название репозитория
- `path` (обязательно) - путь к файлу
- `ref` (опционально) - ветка, тег или commit SHA

**Пример:**

```json
{
  "owner": "facebook",
  "repo": "react",
  "path": "README.md"
}
```

### 3. `github_get_pr_list` - Список Pull Request'ов

Получение списка PR в репозитории.

**Параметры:**

- `owner` (обязательно) - владелец репозитория
- `repo` (обязательно) - название репозитория
- `state` (опционально) - состояние PR: `open`, `closed`, `all` (по умолчанию `open`)
- `per_page` (опционально) - количество результатов (по умолчанию 30, макс 100)

**Пример:**

```json
{
  "owner": "facebook",
  "repo": "react",
  "state": "open",
  "per_page": 10
}
```

### 4. `github_get_pr_info` - Детальная информация о PR

Получение подробной информации о конкретном Pull Request.

**Параметры:**

- `owner` (обязательно) - владелец репозитория
- `repo` (обязательно) - название репозитория
- `prNumber` (обязательно) - номер PR

**Пример:**

```json
{
  "owner": "facebook",
  "repo": "react",
  "prNumber": 12345
}
```

### 5. `github_get_pr_files` - Список измененных файлов в PR

Получение списка файлов, измененных в Pull Request.

**Параметры:**

- `owner` (обязательно) - владелец репозитория
- `repo` (обязательно) - название репозитория
- `prNumber` (обязательно) - номер PR

**Пример:**

```json
{
  "owner": "facebook",
  "repo": "react",
  "prNumber": 12345
}
```

### 6. `github_get_pr_diff` - Полный diff Pull Request

Получение полного unified diff всех изменений в PR.

**Параметры:**

- `owner` (обязательно) - владелец репозитория
- `repo` (обязательно) - название репозитория
- `prNumber` (обязательно) - номер PR

**Пример:**

```json
{
  "owner": "facebook",
  "repo": "react",
  "prNumber": 12345
}
```

## Типичные сценарии использования

### Сценарий 1: Изучение структуры репозитория

1. Просмотреть корневую директорию:

   ```
   github_list_repo_contents(owner="facebook", repo="react")
   ```

2. Просмотреть конкретную папку:

   ```
   github_list_repo_contents(owner="facebook", repo="react", path="packages/react")
   ```

3. Прочитать README:
   ```
   github_read_file(owner="facebook", repo="react", path="README.md")
   ```

### Сценарий 2: Код-ревью Pull Request

1. Получить список открытых PR:

   ```
   github_get_pr_list(owner="facebook", repo="react", state="open")
   ```

2. Получить детальную информацию о PR:

   ```
   github_get_pr_info(owner="facebook", repo="react", prNumber=12345)
   ```

3. Посмотреть список измененных файлов:

   ```
   github_get_pr_files(owner="facebook", repo="react", prNumber=12345)
   ```

4. Получить полный diff для анализа:

   ```
   github_get_pr_diff(owner="facebook", repo="react", prNumber=12345)
   ```

5. Прочитать конкретные измененные файлы для детального анализа:
   ```
   github_read_file(owner="facebook", repo="react", path="packages/react/src/React.js", ref="pr-branch-name")
   ```

### Сценарий 3: Анализ изменений в конкретной ветке

Используйте параметр `ref` для чтения файлов из конкретной ветки:

```
github_read_file(owner="facebook", repo="react", path="package.json", ref="main")
```

## Обработка ошибок

Все инструменты возвращают сообщения об ошибках в следующих случаях:

- **404** - репозиторий или файл не найден
- **403** - доступ запрещен (возможно, нужен токен для приватного репозитория)
- **401** - неверный токен аутентификации
- **Rate limit exceeded** - превышен лимит запросов к API

## Ограничения

- Максимальный размер файла для чтения через API: ~1 МБ
- Для больших репозиториев рекомендуется использовать фильтрацию по path
- Diff PR может быть очень большим для PR с множеством изменений

## Best Practices

1. **Используйте токен** для увеличения лимита запросов
2. **Кэшируйте результаты** на стороне клиента, если делаете повторные запросы
3. **Фильтруйте по path** при просмотре больших репозиториев
4. **Проверяйте размер** перед чтением файлов
5. **Используйте `per_page`** для ограничения количества PR в списке
